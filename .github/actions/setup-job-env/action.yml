name: "Restore Job Environment"
description: "Restores Node.js, PNPM, and workspace from cache."
inputs:
  node_version:
    description: 'Node.js version to use (e.g., "20")'
    required: true
    default: "lts/*"
runs:
  using: "composite"
  steps:
    - name: Install pnpm
      uses: pnpm/action-setup@v4
    
    - name: Use Node.js ${{ inputs.node_version }}
      uses: actions/setup-node@v4
      with:
        node-version: ${{ inputs.node_version }}
        cache: "pnpm"
    
    # Restore the cached workspace
    - name: Restore workspace cache
      uses: actions/cache/restore@v3
      with:
        path: |
          node_modules
          **/node_modules
          **/dist
          **/build
        key: pnpm-workspace-${{ runner.os }}-${{ hashFiles('**/pnpm-lock.yaml') }}-${{ github.sha }}
        fail-on-cache-miss: true
      shell: bash